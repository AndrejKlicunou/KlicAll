{
    "contents" : "library(MASS)\nx1<-rnorm(20,mean = 0,sd = 8/3)\ny1<-rnorm(20,0,8/3)\nx2<-rnorm(20,8,8/3)\nx2<-rnorm(10,8,8/3)\nx2\ny2<-rnorm(10,8,8/3)\nxy<-cbind(c(x1, x2),c(y1, y2))\nxy\nn<-30\nn.train<-floor(n*0.7)\nn.test<-n-n.train\nxy\nidx.train<-sample(1:n,n.train)\nidx.test<-(1:n)[!(1:n %in% idx.train)]\ndata.train<-xy[idx.train,]\ndata.test<-xy[idx.test,]\ncl<-kmeans(xy,2)\ncl.cluster<-cl$cluster\ncl.train<-cl.cluster[idx.train]\ncl.test<-cl.cluster[idx.test]\nmod<-qda(data.train, cl.train)\ncl.test_est<-predict(mod, data.test)$class\nsum(cl.test_est!=cl.test)/n.test\nidx<-idx.test[cl.test_est!=cl.test]\nplot(xy, type=\"n\")\nxy\npoints(data.train,pch=24, col=ifelse(cl.train==1,\"blue\",\"green\"))\nlegend(\"topleft\",legend=c(\"train - 1\",\"train - 2\"),pch=24,col=c(\"blue\",\"green\"))\npoints(data.test,pch=21, col=ifelse(cl.test==1,\"blue\",\"green\"))\nlegend(\"bottomright\",legend=c(\"test - 1\",\"test - 2\"),pch=21,col=c(\"blue\",\"green\"))\nif (length(idx)==1){\npoints(xy[idx,1],xy[idx,2],col=\"red\", pch=4)\n}else\npoints(xy[idx,],col=\"red\", pch=4)\nlegend(\"bottom\",legend=c(\"wrong\"),pch=4,col=\"red\")\nidd<-sample(1:n.train,n.train * 0.2)\nfor(i in idd)\ncl.train[i]=ifelse(cl.train[i]==1,2,1)\nmod2<-qda(data.train, cl.train)\ncl.test_est<-predict(mod2, data.test)$class\nsum(cl.test_est!=cl.test)/n.test\nidx2<-idx.test[cl.test_est!=cl.test]\nidx2\nplot(xy, type=\"n\")\npoints(data.train,pch=24, col=ifelse(cl.train==1,\"blue\",\"green\"))\nlegend(\"topleft\",legend=c(\"train - 1\",\"train - 2\"),pch=24,col=c(\"blue\",\"green\"))\npoints(data.test,pch=21, col=ifelse(cl.test==1,\"blue\",\"green\"))\nlegend(\"bottomright\",legend=c(\"test - 1\",\"test - 2\"),pch=21,col=c(\"blue\",\"green\"))\nif (length(idx2)==1){points(xy[idx2,1],xy[idx2,2],col=\"red\", pch=4)\n}else\npoints(xy[idx2,],col=\"red\", pch=4)\nlegend(\"bottom\",legend=c(\"wrong\"),pch=4,col=\"red\")\nsave.image(\"E:/NaFaNyA_files/ВКИАД (Введение в компьютерный и интеллектуальный анализ данных)/labs/zad6/zad6.RData\")\nView(data.test)\nView(data.test)\nidx2\nidx\npoints(xy[idx2,1],xy[idx2,2],col=\"red\", pch=4)\n}else\npoints(xy[idx2,],col=\"red\", pch=4)\nlegend(\"bottom\",legend=c(\"wrong\"),pch=4,col=\"red\")\nplot(xy, type=\"n\")\nplot(xy, type=\"n\")\npoints(data.train,pch=24, col=ifelse(cl.train==1,\"blue\",\"green\"))\nlegend(\"topleft\",legend=c(\"train - 1\",\"train - 2\"),pch=24,col=c(\"blue\",\"green\"))\npoints(data.test,pch=21, col=ifelse(cl.test==1,\"blue\",\"green\"))\nlegend(\"bottomright\",legend=c(\"test - 1\",\"test - 2\"),pch=21,col=c(\"blue\",\"green\"))\n",
    "created" : 1448083192163.000,
    "dirty" : true,
    "encoding" : "",
    "folds" : "",
    "hash" : "4109239491",
    "id" : "C6BF52C9",
    "lastKnownWriteTime" : 7148388417764667949,
    "path" : null,
    "project_path" : null,
    "properties" : {
        "tempName" : "Untitled1"
    },
    "source_on_save" : false,
    "type" : "r_source"
}